<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ site.name }} - Research Portfolio</title>
  <link rel="stylesheet" href="{{ '/assets/css/academic.css' | relative_url }}">
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&family=Inter:wght@300;400;500&display=swap"
    rel="stylesheet">
  <!-- Prism -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-solarizedlight.min.css"
    rel="stylesheet" />
</head>

<body>
  <div class="academic-container">
    <aside class="academic-sidebar">
      <header>
        <h1>{{ site.name }}</h1>
        <p>{{ site.title }}</p>
      </header>

      <!-- Personal Statement -->
      <section class="personal-statement">
        <p class="statement-text">
          A research-driven software engineer specializing in scalable architecture, machine learning systems, and
          algorithmic optimization. My work bridges the gap between theoretical computer science and practical
          application, with a focus on healthcare AI, data science, and biomedical innovation.
        </p>
        <small class="statement-note">ðŸ’¡ Professional bio showcasing expertise areas</small>
      </section>

      <nav class="project-list" id="project-list">
        {% assign projects = site.data.projects %}
        {% if projects %}
        {% for project in projects %}
        <div class="project-item" onclick="showProject(this)" data-index="{{ forloop.index0 }}">
          <span class="project-title">{{ project.name }}</span>
          <span class="project-meta">
            {% if project.stars > 0 %}â˜… {{ project.stars }} |{% endif %}
            {{ project.languages[0] }}
          </span>
        </div>
        {% endfor %}
        {% else %}
        <div style="padding: 1.5rem">
          <p>Loading projects...</p>
          <small>Run <code>python scripts/audit_and_doc.py</code> to generate data.</small>
        </div>
        {% endif %}
      </nav>
    </aside>
    <main class="academic-canvas" id="project-canvas">
      <div class="empty-state">Select a project to view "World-Class" documentation.</div>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>

  <script type="application/json" id="project-data-json">
    {{ site.data.projects | jsonify }}
  </script>

  <script>
    var projects = JSON.parse(document.getElementById('project-data-json').textContent);

    function showProject(element) {
      // Highlight active item
      document.querySelectorAll('.project-item').forEach(el => el.classList.remove('active'));
      element.classList.add('active');

      var index = parseInt(element.getAttribute('data-index'));
      var p = projects[index];

      // Render technical architecture if available
      var techArchSection = '';
      if (p.technical_architecture) {
        techArchSection = `
          <div class="tech-arch-section">
            <button class="tech-arch-toggle" onclick="toggleTechArch(event)">
              <span class="toggle-icon">â–¶</span> Technical Architecture
            </button>
            <div class="tech-arch-content" style="display:none">
              ${marked.parse(p.technical_architecture || '')}
            </div>
          </div>
        `;
      }

      // Render abstract if available
      var abstractSection = '';
      if (p.abstract) {
        abstractSection = `
          <div class="abstract-section">
            <h3>Abstract</h3>
            <p class="abstract-text">${p.abstract}</p>
          </div>
        `;
      }

      var content = `
            <article class="paper-modal">
                <h1>${p.name}</h1>
                <div class="meta-row">
                    <span>${(p.languages || []).join(', ')}${p.frameworks && p.frameworks.length ? ' â€¢ ' + p.frameworks.join(', ') : ''}</span>
                    <a href="${p.url}" target="_blank" class="git-link">View on GitHub â†’</a>
                </div>
                ${abstractSection}
                ${techArchSection}
                <div class="markdown-body">
                    <h3>Documentation</h3>
                    ${marked.parse(p.documentation || '')}
                </div>
            </article>
        `;
      document.getElementById('project-canvas').innerHTML = content;
      Prism.highlightAll();

      // Scroll to top of canvas
      document.getElementById('project-canvas').scrollTop = 0;
    }

    function toggleTechArch(event) {
      event.stopPropagation();
      var button = event.currentTarget;
      var content = button.nextElementSibling;
      var icon = button.querySelector('.toggle-icon');

      if (content.style.display === 'none') {
        content.style.display = 'block';
        icon.textContent = 'â–¼';
      } else {
        content.style.display = 'none';
        icon.textContent = 'â–¶';
      }
    }

    // Auto-select first project if available
    /*
    window.onload = function() {
        var items = document.querySelectorAll('.project-item');
        if(items.length > 0) {
            items[0].click();
        }
    }
    */
  </script>
</body>

</html>